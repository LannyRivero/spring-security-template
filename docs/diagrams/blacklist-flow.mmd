flowchart TD

    A[Recibir Refresh Token] --> B{¿Está en blacklist?}
    B -- Sí --> X[Rechazar - 401]
    B -- No --> C[Validar firma y expiración]
    C --> D[Registrar reuse]
    D --> E[Blacklisting del token anterior]
    E --> F[Emitir nuevo access token]
    F --> G[Emitir nuevo refresh token]
    G --> H[Enviar respuesta]
